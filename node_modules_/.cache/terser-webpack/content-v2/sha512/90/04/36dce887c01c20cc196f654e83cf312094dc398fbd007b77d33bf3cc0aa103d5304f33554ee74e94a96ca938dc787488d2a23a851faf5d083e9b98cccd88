{"code":"(window.webpackJsonp=window.webpackJsonp||[]).push([[23],{\"Z+oU\":function(module,__webpack_exports__,__webpack_require__){\"use strict\";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,\"ScanJobPageModule\",(function(){return scan_job_module_ScanJobPageModule}));var common=__webpack_require__(\"ofXK\"),fesm2015_forms=__webpack_require__(\"3Pt+\"),router=__webpack_require__(\"tyNb\"),fesm5=__webpack_require__(\"c7TG\"),tslib_es6=__webpack_require__(\"mrSG\"),ngx=__webpack_require__(\"WdVq\"),_ivy_ngcc_ngx=__webpack_require__(\"SmVF\"),rest_api_service=__webpack_require__(\"HSMY\"),core=__webpack_require__(\"fXoL\"),ionic_storage=__webpack_require__(\"e8h1\");function ScanJobPage_ion_item_12_Template(rf,ctx){if(1&rf&&(core[\"ɵɵelementStart\"](0,\"ion-item\"),core[\"ɵɵelementStart\"](1,\"ion-row\"),core[\"ɵɵelementStart\"](2,\"ion-col\",3),core[\"ɵɵelementStart\"](3,\"ion-label\"),core[\"ɵɵtext\"](4),core[\"ɵɵelementEnd\"](),core[\"ɵɵelementEnd\"](),core[\"ɵɵelementEnd\"](),core[\"ɵɵelementEnd\"]()),2&rf){const barcode_r3=ctx.$implicit;core[\"ɵɵadvance\"](4),core[\"ɵɵtextInterpolate1\"](\" \",barcode_r3,\" \")}}function ScanJobPage_ion_item_13_Template(rf,ctx){if(1&rf&&(core[\"ɵɵelementStart\"](0,\"ion-item\"),core[\"ɵɵelementStart\"](1,\"ion-row\"),core[\"ɵɵelementStart\"](2,\"ion-col\",3),core[\"ɵɵelementStart\"](3,\"ion-label\"),core[\"ɵɵtext\"](4),core[\"ɵɵelementEnd\"](),core[\"ɵɵelementEnd\"](),core[\"ɵɵelementEnd\"](),core[\"ɵɵelementEnd\"]()),2&rf){const barcode_r4=ctx.$implicit;core[\"ɵɵadvance\"](4),core[\"ɵɵtextInterpolate1\"](\" \",barcode_r4.key,\" \")}}const routes=[{path:\"\",component:(()=>{class ScanJobPage{constructor(api,barcodeScanner,toast,storage,router,route,loadingController,toastController){this.api=api,this.barcodeScanner=barcodeScanner,this.toast=toast,this.storage=storage,this.router=router,this.route=route,this.loadingController=loadingController,this.toastController=toastController,this.barcodePush=[],this.connote_new=[],this.count_connote=0}ngOnInit(){this.getSend()}getSend(){return Object(tslib_es6.b)(this,void 0,void 0,(function*(){const loading=yield this.loadingController.create({});this.sends=[],yield loading.present(),this.storage.get(\"emp_key\").then(val=>{this.api.getSend(val).subscribe(res=>{console.log(res),\"success\"==res.result&&(this.sends=res.data),loading.dismiss()},err=>{console.log(err),loading.dismiss()})})}))}rmBarcode(message){return Object(tslib_es6.b)(this,void 0,void 0,(function*(){const loading=yield this.loadingController.create({});yield loading.present(),this.api.deleteJob(message).subscribe(res=>{if(console.log(res),\"success\"==res.result){this.count_connote=Number(this.count_connote)-1,this.count_connote<0&&(this.count_connote=0);const index=this.barcodePush.indexOf(message);-1!==index&&this.barcodePush.splice(index,1),loading.dismiss(),this.alert(res.result+\" \"+res.desc)}else this.alert(res.result+\" \"+res.desc)},err=>{this.alert(err),console.log(err),loading.dismiss()})}))}scan(){this.options={prompt:\"พยายามวางบาร์โค้ดไว้ตรงกลางจอ\",disableSuccessBeep:!1,resultDisplayDuration:500,saveHistory:!0,showTorchButton:!0,showFlipCameraButton:!0},this.barcodeScanner.scan(this.options).then(barcodeData=>{if(this.barcode=barcodeData.text,barcodeData.cancelled)return console.log(\"User cancelled the action!\"),!1;this.check_loop=0,\"\"!=this.barcode&&(this.barcodePush.forEach(snap=>{snap==this.barcode&&(this.check_loop=1)}),0==this.check_loop?(this.sendData(this.barcode),this.toast.show(barcodeData.text,\"200\",\"center\").subscribe(toast=>{console.log(toast)})):this.alert(this.barcode+\" Dupplicate.\"))},err=>{this.toast.show(err,\"5000\",\"center\").subscribe(toast=>{console.log(toast)})})}submitForm(){return Object(tslib_es6.b)(this,void 0,void 0,(function*(){\"\"!=this.barcode&&(this.sendData(this.barcode),this.storage.set(\"keyOfDataJob\",JSON.stringify(this.barcodePush))),this.storage.get(\"keyOfDataJob\").then(val=>{\"\"!=val&&(this.connote_new=JSON.parse(val))})}))}sendData(barcode){return Object(tslib_es6.b)(this,void 0,void 0,(function*(){for(var duplicate=!1,i=0;i<=this.barcodePush.length-1;i++)this.barcodePush[i]==this.barcode&&(duplicate=!0);if(duplicate);else{const loading=yield this.loadingController.create({});yield loading.present(),this.storage.get(\"emp_key\").then(val=>{this.emp_key=val,this.api.createJob(barcode,this.emp_key).subscribe(res=>{\"success\"==res.result?(this.connote_new.push(this.barcode),this.count_connote=Number(this.count_connote)+1,this.alert(res.result+\" \"+res.desc+\" \"+this.barcode),this.barcodePush.push(this.barcode),loading.dismiss()):(this.alert(res.result+\" \"+res.desc),loading.dismiss())},err=>{this.alert(err),console.log(err),loading.dismiss()})})}}))}removeBarcode(){}alert(result){return Object(tslib_es6.b)(this,void 0,void 0,(function*(){(yield this.toastController.create({message:\"Add connote \"+result,duration:2e3})).present()}))}}return ScanJobPage.ɵfac=function(t){return new(t||ScanJobPage)(core[\"ɵɵdirectiveInject\"](rest_api_service.a),core[\"ɵɵdirectiveInject\"](ngx.a),core[\"ɵɵdirectiveInject\"](_ivy_ngcc_ngx.a),core[\"ɵɵdirectiveInject\"](ionic_storage.b),core[\"ɵɵdirectiveInject\"](router.f),core[\"ɵɵdirectiveInject\"](router.a),core[\"ɵɵdirectiveInject\"](fesm5.E),core[\"ɵɵdirectiveInject\"](fesm5.K))},ScanJobPage.ɵcmp=core[\"ɵɵdefineComponent\"]({type:ScanJobPage,selectors:[[\"app-scan\"]],decls:28,vars:5,consts:[[1,\"header\"],[\"slot\",\"start\"],[\"color\",\"warning\",\"expand\",\"full\",\"routerLink\",\"/members/dashboard/send\"],[\"size\",\"12\"],[4,\"ngFor\",\"ngForOf\"],[3,\"ngSubmit\"],[\"form\",\"ngForm\"],[\"name\",\"barcode\",\"type\",\"text\",\"placeholder\",\"หมายเลขบาร์โค้ด\",\"required\",\"\",3,\"ngModel\",\"ngModelChange\"],[\"size\",\"6\"],[\"expand\",\"full\",\"type\",\"submit\",\"color\",\"primary\",3,\"disabled\"],[\"color\",\"dark\",\"expand\",\"full\",3,\"click\"]],template:function(rf,ctx){if(1&rf&&(core[\"ɵɵelementStart\"](0,\"ion-header\"),core[\"ɵɵelementStart\"](1,\"ion-toolbar\",0),core[\"ɵɵelementStart\"](2,\"ion-buttons\",1),core[\"ɵɵelementStart\"](3,\"ion-button\",2),core[\"ɵɵtext\"](4,\"< กลับ\"),core[\"ɵɵelementEnd\"](),core[\"ɵɵelementEnd\"](),core[\"ɵɵelementStart\"](5,\"ion-title\"),core[\"ɵɵtext\"](6,\"บาร์โคด Connote ส่งของ\"),core[\"ɵɵelementEnd\"](),core[\"ɵɵelementEnd\"](),core[\"ɵɵelementEnd\"](),core[\"ɵɵelementStart\"](7,\"ion-content\"),core[\"ɵɵelementStart\"](8,\"ion-item\"),core[\"ɵɵelementStart\"](9,\"ion-row\"),core[\"ɵɵelementStart\"](10,\"ion-col\",3),core[\"ɵɵtext\"](11),core[\"ɵɵelementEnd\"](),core[\"ɵɵelementEnd\"](),core[\"ɵɵelementEnd\"](),core[\"ɵɵtemplate\"](12,ScanJobPage_ion_item_12_Template,5,1,\"ion-item\",4),core[\"ɵɵtemplate\"](13,ScanJobPage_ion_item_13_Template,5,1,\"ion-item\",4),core[\"ɵɵelementEnd\"](),core[\"ɵɵelementStart\"](14,\"form\",5,6),core[\"ɵɵlistener\"](\"ngSubmit\",(function(){return ctx.submitForm()})),core[\"ɵɵelementStart\"](16,\"ion-grid\"),core[\"ɵɵelementStart\"](17,\"ion-row\"),core[\"ɵɵelementStart\"](18,\"ion-col\",3),core[\"ɵɵelementStart\"](19,\"ion-item\"),core[\"ɵɵelementStart\"](20,\"ion-input\",7),core[\"ɵɵlistener\"](\"ngModelChange\",(function($event){return ctx.barcode=$event})),core[\"ɵɵelementEnd\"](),core[\"ɵɵelementEnd\"](),core[\"ɵɵelementEnd\"](),core[\"ɵɵelementEnd\"](),core[\"ɵɵelementStart\"](21,\"ion-row\"),core[\"ɵɵelementStart\"](22,\"ion-col\",8),core[\"ɵɵelementStart\"](23,\"ion-button\",9),core[\"ɵɵtext\"](24,\"ยืนยัน บาร์โค้ด\"),core[\"ɵɵelementEnd\"](),core[\"ɵɵelementEnd\"](),core[\"ɵɵelementStart\"](25,\"ion-col\",8),core[\"ɵɵelementStart\"](26,\"ion-button\",10),core[\"ɵɵlistener\"](\"click\",(function(){return ctx.scan()})),core[\"ɵɵtext\"](27,\"แสกน connote\"),core[\"ɵɵelementEnd\"](),core[\"ɵɵelementEnd\"](),core[\"ɵɵelementEnd\"](),core[\"ɵɵelementEnd\"](),core[\"ɵɵelementEnd\"]()),2&rf){const _r2=core[\"ɵɵreference\"](15);core[\"ɵɵadvance\"](11),core[\"ɵɵtextInterpolate1\"](\" จำนวน Connote ที่เพิ่ม \",ctx.count_connote,\" \"),core[\"ɵɵadvance\"](1),core[\"ɵɵproperty\"](\"ngForOf\",ctx.barcodePush),core[\"ɵɵadvance\"](1),core[\"ɵɵproperty\"](\"ngForOf\",ctx.sends),core[\"ɵɵadvance\"](7),core[\"ɵɵproperty\"](\"ngModel\",ctx.barcode),core[\"ɵɵadvance\"](3),core[\"ɵɵproperty\"](\"disabled\",_r2.invalid)}},directives:[fesm5.n,fesm5.B,fesm5.g,fesm5.f,fesm5.I,router.g,fesm5.A,fesm5.k,fesm5.q,fesm5.w,fesm5.j,common.i,fesm2015_forms.j,fesm2015_forms.e,fesm2015_forms.f,fesm5.m,fesm5.p,fesm5.J,fesm2015_forms.i,fesm2015_forms.d,fesm2015_forms.g,fesm5.r],styles:[\".header[_ngcontent-%COMP%]{padding:20px 0;--background:#3f51b5}.header[_ngcontent-%COMP%]   ion-back-button[_ngcontent-%COMP%], .header[_ngcontent-%COMP%]   ion-title[_ngcontent-%COMP%]{color:#fff}\"]}),ScanJobPage})()}];let scan_job_module_ScanJobPageModule=(()=>{class ScanJobPageModule{}return ScanJobPageModule.ɵmod=core[\"ɵɵdefineNgModule\"]({type:ScanJobPageModule}),ScanJobPageModule.ɵinj=core[\"ɵɵdefineInjector\"]({factory:function(t){return new(t||ScanJobPageModule)},imports:[[common.b,fesm2015_forms.b,fesm5.C,router.h.forChild(routes)]]}),ScanJobPageModule})()}}]);","extractedComments":[]}