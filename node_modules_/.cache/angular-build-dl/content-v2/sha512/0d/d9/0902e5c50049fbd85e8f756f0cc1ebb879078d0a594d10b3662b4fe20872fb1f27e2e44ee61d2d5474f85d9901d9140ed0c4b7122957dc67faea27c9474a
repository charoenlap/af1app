(window["webpackJsonp"] = window["webpackJsonp"] || []).push([["dashboard-scan-job-scan-job-module"],{

/***/ "ME51":
/*!*****************************************************************************************************!*\
  !*** ./node_modules/raw-loader/dist/cjs.js!./src/app/members/dashboard/scan-job/scan-job.page.html ***!
  \*****************************************************************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony default export */ __webpack_exports__["default"] = ("<ion-header>\n  <ion-toolbar class=\"header\">\n    <ion-buttons slot=\"start\">\n      <ion-button color=\"warning\" expand=\"full\" routerLink=\"/members/dashboard/send\">< กลับ</ion-button>\n    </ion-buttons>\n    <ion-title>บาร์โคด Connote ส่งของ</ion-title>\n  </ion-toolbar>\n</ion-header>\n\n<ion-content>\n\t\n\t<ion-item>\n\t\t<ion-row>\n        \t<ion-col size=\"12\">\n\t\t\t\tจำนวน Connote ที่เพิ่ม {{count_connote}}\n        \t</ion-col>\n        </ion-row>\n\t</ion-item>\n\t<ion-item *ngFor=\"let barcode of barcodePush\">\n\t\t<ion-row>\n        \t<ion-col size=\"12\">\n\t\t\t\t<ion-label>\n\t\t\t\t\t<!-- <ion-button color=\"danger\" expand=\"\" (click)=\"rmBarcode(barcode)\">\n\t\t\t\t\t\t<ion-icon name=\"close\" ></ion-icon>\n\t\t\t\t\t</ion-button>  -->\n\t\t\t\t\t{{barcode}}\n\t\t\t\t</ion-label>\n        \t</ion-col>\n        </ion-row>\n    </ion-item>\n    <ion-item *ngFor=\"let barcode of sends\">\n\t\t<ion-row>\n        \t<ion-col size=\"12\">\n\t\t\t\t<ion-label>\n\t\t\t\t\t<!-- <ion-button color=\"danger\" expand=\"\" (click)=\"rmBarcode(barcode.key)\">\n\t\t\t\t\t\t<ion-icon name=\"close\" ></ion-icon>\n\t\t\t\t\t</ion-button>  -->\n\t\t\t\t{{barcode.key}} </ion-label>\n        \t</ion-col>\n        </ion-row>\n    </ion-item>\n</ion-content>\n<form #form=\"ngForm\" (ngSubmit)=\"submitForm()\" >\n\t<ion-grid >\n        <ion-row>\n        \t<ion-col size=\"12\">\n\t          \t<ion-item>\n\t\t\t\t  <ion-input [(ngModel)]=\"barcode\" name=\"barcode\" type=\"text\" placeholder=\"หมายเลขบาร์โค้ด\" required></ion-input>\n\t\t\t\t</ion-item>\n        \t</ion-col>\n        </ion-row>\n        <ion-row>\n        \t<ion-col size=\"6\">\n\t\t\t\t  <ion-button expand=\"full\" type=\"submit\" color=\"primary\" [disabled]=\"form.invalid\" >ยืนยัน บาร์โค้ด</ion-button>\n        \t</ion-col>\n        \t<ion-col size=\"6\">\n        \t\t<ion-button color=\"dark\" expand=\"full\" (click)=\"scan()\">แสกน connote</ion-button>\n        \t</ion-col>\n        </ion-row>\n    </ion-grid>\n</form>");

/***/ }),

/***/ "QmC8":
/*!*************************************************************!*\
  !*** ./src/app/members/dashboard/scan-job/scan-job.page.ts ***!
  \*************************************************************/
/*! exports provided: ScanJobPage */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ScanJobPage", function() { return ScanJobPage; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "mrSG");
/* harmony import */ var _raw_loader_scan_job_page_html__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! raw-loader!./scan-job.page.html */ "ME51");
/* harmony import */ var _scan_job_page_scss__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./scan-job.page.scss */ "qFIw");
/* harmony import */ var _angular_core__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @angular/core */ "fXoL");
/* harmony import */ var _ionic_angular__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @ionic/angular */ "c7TG");
/* harmony import */ var _ionic_native_barcode_scanner_ngx__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @ionic-native/barcode-scanner/ngx */ "WdVq");
/* harmony import */ var _ionic_native_toast_ngx__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! @ionic-native/toast/ngx */ "SmVF");
/* harmony import */ var _ionic_storage__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! @ionic/storage */ "e8h1");
/* harmony import */ var _angular_router__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! @angular/router */ "tyNb");
/* harmony import */ var _rest_api_service__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../../../rest-api.service */ "HSMY");











let ScanJobPage = class ScanJobPage {
    constructor(api, barcodeScanner, toast, storage, router, route, loadingController, toastController) {
        this.api = api;
        this.barcodeScanner = barcodeScanner;
        this.toast = toast;
        this.storage = storage;
        this.router = router;
        this.route = route;
        this.loadingController = loadingController;
        this.toastController = toastController;
        this.barcodePush = [];
        this.connote_new = [];
        this.count_connote = 0;
    }
    ngOnInit() {
        this.getSend();
    }
    getSend() {
        return Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"])(this, void 0, void 0, function* () {
            const loading = yield this.loadingController.create({
            // content: 'Loading'
            });
            this.sends = [];
            yield loading.present();
            this.storage.get('emp_key').then((val) => {
                // console.log(val);
                this.api.getSend(val).subscribe(res => {
                    console.log(res);
                    if (res.result == 'success') {
                        this.sends = res.data;
                    }
                    // this.loginDetail = res;
                    // console.log(this.loginDetail);
                    loading.dismiss();
                }, err => {
                    console.log(err);
                    loading.dismiss();
                });
            });
        });
    }
    rmBarcode(message) {
        return Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"])(this, void 0, void 0, function* () {
            const loading = yield this.loadingController.create({});
            yield loading.present();
            this.api.deleteJob(message).subscribe(res => {
                console.log(res);
                if (res.result == "success") {
                    this.count_connote = Number(this.count_connote) - 1;
                    if (this.count_connote < 0) {
                        this.count_connote = 0;
                    }
                    const index = this.barcodePush.indexOf(message);
                    if (index !== -1) {
                        this.barcodePush.splice(index, 1);
                    }
                    loading.dismiss();
                    // this.router.navigateByUrl('/members/dashboard/job');
                    // this.router.navigate(['/members/dashboard/job']);
                    this.alert(res.result + " " + res.desc);
                }
                else {
                    this.alert(res.result + " " + res.desc);
                }
            }, err => {
                this.alert(err);
                console.log(err);
                loading.dismiss();
            });
            // delete [this.barcodePush.indexOf(message)];
        });
    }
    scan() {
        this.options = {
            // formats: "QR_CODE",
            prompt: "พยายามวางบาร์โค้ดไว้ตรงกลางจอ",
            // orientation : "landscape",
            disableSuccessBeep: false,
            resultDisplayDuration: 500,
            saveHistory: true,
            // torchOn: true,
            showTorchButton: true,
            showFlipCameraButton: true,
        };
        this.barcodeScanner.scan(this.options).then((barcodeData) => {
            this.barcode = barcodeData.text;
            if (barcodeData.cancelled) {
                console.log("User cancelled the action!");
                return false;
            }
            this.check_loop = 0;
            if (this.barcode != '') {
                this.barcodePush.forEach((snap) => {
                    if (snap == this.barcode) {
                        this.check_loop = 1;
                    }
                });
                if (this.check_loop == 0) {
                    this.sendData(this.barcode);
                    this.toast.show(barcodeData.text, '200', 'center').subscribe(toast => {
                        console.log(toast);
                    });
                }
                else {
                    this.alert(this.barcode + ' ' + 'Dupplicate.');
                }
            }
            // this.barcode = '';
        }, (err) => {
            this.toast.show(err, '5000', 'center').subscribe(toast => {
                console.log(toast);
            });
        });
    }
    submitForm() {
        return Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"])(this, void 0, void 0, function* () {
            if (this.barcode != '') {
                this.sendData(this.barcode);
                // this.barcodePush.push(this.barcode);
                // // this.barcodePush.push(this.barcode);
                this.storage.set('keyOfDataJob', JSON.stringify(this.barcodePush));
                // // // this.alert(this.barcode);
                // this.connote_new.push(this.barcode);
                // // Start 
                // this.storage.get('emp_key').then((val) => {
                //   this.emp_key = val.toString();
                // });
                // const loading = await this.loadingController.create({
                // // content: 'Loading'
                // });
                // await loading.present();
                // await this.api.createJob(this.barcode,this.emp_key)
                // .subscribe(res => {
                //   console.log(res);
                //   // this.barcodePush.push(this.barcode);
                //   // alert(res.result);
                //   this.alert(res.result);
                //   // this.getJobDetail();
                //   loading.dismiss();
                //   // this.router.navigateByUrl('/members/dashboard/job');
                //   // this.router.navigate(['/members/dashboard/job']);
                // }, err => {
                //   console.log(err);
                //   loading.dismiss();
                // });
                // // End
                // // console.log(this.connote_new);
                // this.barcode = '';
            }
            this.storage.get('keyOfDataJob').then((val) => {
                if (val != '') {
                    this.connote_new = JSON.parse(val);
                }
            });
            // this.toast.show('Submit', '200', 'center').subscribe(
            //    toast => {
            //      // console.log(toast);
            //    }
            //  );
            // this.storage.get('keyOfDataJob').then((val) => {
            //    console.log(val);
            //    // this.textPrint = JSON.parse(val);
            //  });
        });
    }
    sendData(barcode) {
        return Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"])(this, void 0, void 0, function* () {
            var duplicate = false;
            for (var i = 0; i <= this.barcodePush.length - 1; i++) {
                if (this.barcodePush[i] == this.barcode) {
                    duplicate = true;
                }
            }
            if (duplicate) {
            }
            else {
                const loading = yield this.loadingController.create({});
                yield loading.present();
                // Start 
                this.storage.get('emp_key').then((val) => {
                    this.emp_key = val;
                    this.api.createJob(barcode, this.emp_key).subscribe(res => {
                        if (res.result == "success") {
                            // this.storage.set('keyOfData', JSON.stringify(this.barcodePush));
                            this.connote_new.push(this.barcode);
                            // console.log(res);
                            this.count_connote = Number(this.count_connote) + 1;
                            // alert(res.result);
                            this.alert(res.result + ' ' + res.desc + ' ' + this.barcode);
                            this.barcodePush.push(this.barcode);
                            // this.barcodePush.push(barcode);
                            // this.getJobDetail();
                            loading.dismiss();
                            // this.scan();
                            // this.router.navigateByUrl('/members/dashboard/job');
                            // this.router.navigate(['/members/dashboard/job']);
                        }
                        else {
                            this.alert(res.result + " " + res.desc);
                            loading.dismiss();
                        }
                    }, err => {
                        this.alert(err);
                        console.log(err);
                        loading.dismiss();
                    });
                });
            }
            // End
        });
    }
    removeBarcode() {
        // this.storage.set('keyOfDataJob', '');
    }
    alert(result) {
        return Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"])(this, void 0, void 0, function* () {
            const toast = yield this.toastController.create({
                message: 'Add connote ' + result,
                duration: 2000
            });
            toast.present();
        });
    }
};
ScanJobPage.ctorParameters = () => [
    { type: _rest_api_service__WEBPACK_IMPORTED_MODULE_9__["RestApiService"] },
    { type: _ionic_native_barcode_scanner_ngx__WEBPACK_IMPORTED_MODULE_5__["BarcodeScanner"] },
    { type: _ionic_native_toast_ngx__WEBPACK_IMPORTED_MODULE_6__["Toast"] },
    { type: _ionic_storage__WEBPACK_IMPORTED_MODULE_7__["Storage"] },
    { type: _angular_router__WEBPACK_IMPORTED_MODULE_8__["Router"] },
    { type: _angular_router__WEBPACK_IMPORTED_MODULE_8__["ActivatedRoute"] },
    { type: _ionic_angular__WEBPACK_IMPORTED_MODULE_4__["LoadingController"] },
    { type: _ionic_angular__WEBPACK_IMPORTED_MODULE_4__["ToastController"] }
];
ScanJobPage = Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"])([
    Object(_angular_core__WEBPACK_IMPORTED_MODULE_3__["Component"])({
        selector: 'app-scan',
        template: _raw_loader_scan_job_page_html__WEBPACK_IMPORTED_MODULE_1__["default"],
        styles: [_scan_job_page_scss__WEBPACK_IMPORTED_MODULE_2__["default"]]
    }),
    Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__metadata"])("design:paramtypes", [_rest_api_service__WEBPACK_IMPORTED_MODULE_9__["RestApiService"],
        _ionic_native_barcode_scanner_ngx__WEBPACK_IMPORTED_MODULE_5__["BarcodeScanner"],
        _ionic_native_toast_ngx__WEBPACK_IMPORTED_MODULE_6__["Toast"],
        _ionic_storage__WEBPACK_IMPORTED_MODULE_7__["Storage"],
        _angular_router__WEBPACK_IMPORTED_MODULE_8__["Router"],
        _angular_router__WEBPACK_IMPORTED_MODULE_8__["ActivatedRoute"],
        _ionic_angular__WEBPACK_IMPORTED_MODULE_4__["LoadingController"],
        _ionic_angular__WEBPACK_IMPORTED_MODULE_4__["ToastController"]])
], ScanJobPage);



/***/ }),

/***/ "Z+oU":
/*!***************************************************************!*\
  !*** ./src/app/members/dashboard/scan-job/scan-job.module.ts ***!
  \***************************************************************/
/*! exports provided: ScanJobPageModule */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ScanJobPageModule", function() { return ScanJobPageModule; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "mrSG");
/* harmony import */ var _angular_core__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @angular/core */ "fXoL");
/* harmony import */ var _angular_common__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @angular/common */ "ofXK");
/* harmony import */ var _angular_forms__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @angular/forms */ "3Pt+");
/* harmony import */ var _angular_router__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @angular/router */ "tyNb");
/* harmony import */ var _ionic_angular__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @ionic/angular */ "c7TG");
/* harmony import */ var _scan_job_page__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./scan-job.page */ "QmC8");







const routes = [
    {
        path: '',
        component: _scan_job_page__WEBPACK_IMPORTED_MODULE_6__["ScanJobPage"]
    }
];
let ScanJobPageModule = class ScanJobPageModule {
};
ScanJobPageModule = Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"])([
    Object(_angular_core__WEBPACK_IMPORTED_MODULE_1__["NgModule"])({
        imports: [
            _angular_common__WEBPACK_IMPORTED_MODULE_2__["CommonModule"],
            _angular_forms__WEBPACK_IMPORTED_MODULE_3__["FormsModule"],
            _ionic_angular__WEBPACK_IMPORTED_MODULE_5__["IonicModule"],
            _angular_router__WEBPACK_IMPORTED_MODULE_4__["RouterModule"].forChild(routes)
        ],
        declarations: [_scan_job_page__WEBPACK_IMPORTED_MODULE_6__["ScanJobPage"]]
    })
], ScanJobPageModule);



/***/ }),

/***/ "qFIw":
/*!***************************************************************!*\
  !*** ./src/app/members/dashboard/scan-job/scan-job.page.scss ***!
  \***************************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony default export */ __webpack_exports__["default"] = (".header {\n  padding: 20px 0;\n  --background: #3f51b5;\n}\n\n.header ion-title,\n.header ion-back-button {\n  color: #fff;\n}\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNyYy9hcHAvbWVtYmVycy9kYXNoYm9hcmQvc2Nhbi1qb2Ivc2Nhbi1qb2IucGFnZS5zY3NzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBO0VBQ0MsZUFBQTtFQUNBLHFCQUFBO0FBQ0Q7O0FBQ0E7O0VBRUMsV0FBQTtBQUVEIiwiZmlsZSI6InNyYy9hcHAvbWVtYmVycy9kYXNoYm9hcmQvc2Nhbi1qb2Ivc2Nhbi1qb2IucGFnZS5zY3NzIiwic291cmNlc0NvbnRlbnQiOlsiLmhlYWRlciB7XHJcblx0cGFkZGluZzogMjBweCAwO1xyXG5cdC0tYmFja2dyb3VuZDogIzNmNTFiNTtcclxufVxyXG4uaGVhZGVyIGlvbi10aXRsZSxcclxuLmhlYWRlciBpb24tYmFjay1idXR0b24ge1xyXG5cdGNvbG9yOiAjZmZmO1xyXG59Il19 */");

/***/ })

}]);
//# sourceMappingURL=dashboard-scan-job-scan-job-module-es2015.js.map